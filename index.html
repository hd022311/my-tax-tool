<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¯Œé‚¦ä¿Šå¾· | å‚³æ‰¿ä¿å…¨æ™ºæ…§è©¦ç®—</title>
    <script charset="utf-8" src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f3f4f6; }
        
        /* ä»¿åœ–æ¼¸å±¤æ¨™é ­ */
        .header-box {
            background: linear-gradient(135deg, #004a99 0%, #00a950 100%);
            padding: 3.5rem 1.5rem 4.5rem 1.5rem;
            color: white;
            text-align: center;
        }

        .main-container {
            max-width: 450px;
            margin: -2.5rem auto 2rem auto;
            padding: 0 1.25rem;
        }

        .card {
            background: white;
            border-radius: 2rem;
            padding: 1.5rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.05);
        }

        /* æ”¾å¤§å ±å‘Šå­—é«” */
        .report-title { font-size: 1.4rem; font-weight: 900; color: #1e293b; }
        .report-content { font-size: 1.2rem; line-height: 1.8; color: #334155; font-weight: 500; }
        .report-highlight { font-size: 1.6rem; font-weight: 900; color: #004a99; border-bottom: 3px solid #00a950; }
        .risk-text { font-size: 1.2rem; font-weight: 800; color: #dc2626; line-height: 1.6; }
    </style>
</head>
<body>

    <div class="header-box">
        <h1 class="text-3xl font-black tracking-widest mb-1">å¯Œé‚¦äººå£½ | ä¿Šå¾·</h1>
        <p class="text-sm font-bold opacity-80 italic">æ‚¨çš„è³‡ç”¢å®‰å…¨èˆ‡å®¶æ—å‚³æ‰¿ï¼Œç”±æˆ‘ç‚ºæ‚¨å®ˆè­·</p>
    </div>

    <div class="main-container">
        <div class="card mb-6">
            <h3 class="text-lg font-black text-[#004a99] mb-4 border-l-4 border-[#00a950] pl-3">ä¸€ã€è³‡ç”¢æ¦‚æ³ (è¬å…ƒ)</h3>
            <div class="space-y-5">
                <div class="relative">
                    <label class="text-xs font-bold text-slate-400">æˆ¿ç”¢å¸‚åƒ¹</label>
                    <input type="number" id="re" placeholder="è«‹è¼¸å…¥é‡‘é¡" class="w-full p-4 bg-slate-50 rounded-2xl border-0 text-right font-black text-xl">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="text-xs font-bold text-slate-400">ç¾é‡‘å­˜æ¬¾</label>
                        <input type="number" id="cash" placeholder="0" class="w-full p-4 bg-slate-50 rounded-2xl border-0 text-right font-bold text-lg">
                    </div>
                    <div>
                        <label class="text-xs font-bold text-slate-400">è‚¡ç¥¨åŸºé‡‘</label>
                        <input type="number" id="stock" placeholder="0" class="w-full p-4 bg-slate-50 rounded-2xl border-0 text-right font-bold text-lg">
                    </div>
                </div>
            </div>

            <h3 class="text-lg font-black text-[#004a99] mt-8 mb-4 border-l-4 border-[#00a950] pl-3">äºŒã€ç¹¼æ‰¿æˆå“¡</h3>
            <div class="space-y-4">
                <div class="flex items-center justify-between p-4 bg-blue-50 rounded-2xl border border-blue-100">
                    <span class="font-bold text-blue-900 text-lg">æœ‰é…å¶</span>
                    <input type="checkbox" id="spouse" class="w-6 h-6 rounded text-blue-600">
                </div>
                <div class="flex items-center justify-between px-2">
                    <span class="font-bold text-slate-600 text-lg">å­å¥³å¹¾ä½ï¼Ÿ</span>
                    <input type="number" id="child" value="0" class="w-20 bg-slate-100 p-2 text-center rounded-xl border-0 font-black text-xl">
                </div>
                <div class="flex items-center justify-between px-2">
                    <span class="font-bold text-slate-400 text-lg">çˆ¶æ¯å¹¾ä½ï¼Ÿ</span>
                    <input type="number" id="parent" value="0" class="w-20 bg-slate-100 p-2 text-center rounded-xl border-0 font-black text-xl">
                </div>
            </div>
        </div>

        <button onclick="calc()" class="w-full bg-[#004a99] text-white py-5 rounded-[2rem] font-black shadow-xl active:scale-95 transition-all text-xl mb-10">
            é–‹å§‹åˆ†æä¸¦è¨ˆç®—å ±å‘Š
        </button>

        <div id="result" class="hidden mb-20">
            <div class="bg-white rounded-[2.5rem] shadow-2xl overflow-hidden border border-slate-100">
                <div class="bg-slate-800 p-6 text-center text-white">
                    <p class="font-black text-xl tracking-widest">å°ˆæ¥­å‚³æ‰¿å»ºè­°å ±å‘Š</p>
                </div>
                <div id="resultContent" class="p-8 space-y-8">
                    </div>
                <div class="p-8 pt-0">
                    <a href="https://line.me/ti/p/ä½ çš„LINEID" class="block w-full bg-[#00a950] text-white text-center py-5 rounded-2xl font-black shadow-lg text-xl flex items-center justify-center gap-2">
                        ğŸ’¬ ç«‹å³èˆ‡ä¿Šå¾·é ç´„è«®è©¢
                    </a>
                    <p class="text-center text-slate-400 text-[10px] mt-6 leading-relaxed">
                        æœ¬è©¦ç®—ä¾æ°‘æ³•èˆ‡æœ€æ–°æ†²æ³•æ³•åº­åˆ¤æ±ºç²¾ç¥ç·¨è£½ã€‚<br>æ•¸æ“šåŒæ­¥è¨˜éŒ„è‡³ä¿Šå¾·é¡§å•ç³»çµ±ï¼Œå°‡ç”±æˆ‘ç‚ºæ‚¨å®ˆè­·ã€‚
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let userName = "å˜‰è³“";

        async function init() {
            try {
                await liff.init({ liffId: "2008902145-dYIF2R2M" });
                if (liff.isLoggedIn()) {
                    const p = await liff.getProfile();
                    userName = p.displayName;
                } else { liff.login(); }
            } catch (e) { console.log(e); }
        }
        init();

        function sync(data) {
            // å·²å°æ¥æ‚¨çš„è¡¨å–® ID
            const fid = "1lpAzMM1FJQaC8Nqfj6776KQZ-cihe0qVsXo1m4U--XU";
            const url = `https://docs.google.com/forms/d/e/${fid}/formResponse?` +
                `entry.31174987=${encodeURIComponent(userName)}&` +
                `entry.1130638521=${data.total}&` +
                `entry.2001556012=${encodeURIComponent(data.struct)}&` +
                `entry.1017830689=${encodeURIComponent(data.plan)}&` +
                `submit=Submit`;
            fetch(url, { mode: 'no-cors' });
        }

        function calc() {
            const re = parseFloat(document.getElementById('re').value) || 0;
            const cash = parseFloat(document.getElementById('cash').value) || 0;
            const stock = parseFloat(document.getElementById('stock').value) || 0;
            const total = re + cash + stock;
            if (total <= 0) return alert("è«‹è¼¸å…¥è³‡ç”¢");

            const hasSpouse = document.getElementById('spouse').checked;
            const nC = parseInt(document.getElementById('child').value) || 0;
            const nP = parseInt(document.getElementById('parent').value) || 0;

            let target = (nC > 0) ? "å­å¥³" : (nP > 0 ? "çˆ¶æ¯" : "ç¹¼æ‰¿äºº");
            let ratio = (re / total);
            let shift = (ratio > 0.7) ? (re * 0.3) : (cash + stock);

            sync({ total: total, struct: `é…å¶:${hasSpouse?'æœ‰':'ç„¡'},å­:${nC},çˆ¶:${nP}`, plan: ratio > 0.7 ? 'æˆ¿ç”¢æ´»åŒ–' : 'å‚³æ‰¿å„ªåŒ–' });

            document.getElementById('result').classList.remove('hidden');
            document.getElementById('resultContent').innerHTML = `
                <div class="text-center space-y-2">
                    <p class="text-slate-400 font-bold tracking-widest text-sm uppercase">è³‡ç”¢å„ªåŒ–åˆ†æ</p>
                    <p class="text-4xl font-black text-slate-800">${Math.round(total).toLocaleString()}<span class="text-lg"> è¬</span></p>
                </div>

                <div class="p-6 bg-blue-50 rounded-3xl border-2 border-blue-100">
                    <p class="font-black text-[#004a99] text-xl mb-3">ğŸ¯ ä¿Šå¾·å°ˆæ¥­è¦åŠƒå»ºè­°</p>
                    <p class="report-content">
                        å»ºè­°å°‡ <span class="report-highlight">${Math.round(shift).toLocaleString()} è¬</span> ç§»è½‰è‡³ä¿éšªé ç•™é‡‘ã€‚æ­¤è¦åŠƒå¯ä¾æ³•é™ä½æœªä¾†æ‡‰æ”¯ä»˜ä¹‹ç‰¹ç•™åˆ†ï¼Œæœ‰æ•ˆå®ˆè­·å®¶æ—è³‡ç”¢ã€‚
                    </p>
                </div>

                <div class="p-6 bg-red-50 rounded-3xl border-l-8 border-red-500 shadow-sm">
                    <p class="text-red-700 font-black text-xl mb-3">âš ï¸ æ ¸å¿ƒé¢¨éšªè­¦ç¤º</p>
                    <p class="risk-text">
                        ç›®å‰ç¹¼æ‰¿äººåŒ…å« <span class="underline">${target}</span>ã€‚è‹¥ç¾é‡‘ä¸è¶³ä»¥æ”¯ä»˜ç‰¹ç•™åˆ†ï¼Œæˆ¿ç”¢æé¢è‡¨ã€Œå…¬åŒå…±æœ‰ã€ç‹€æ…‹ï¼Œå°è‡´è³‡ç”¢è¢«é–æ­»ã€ç„¡æ³•è‡ªç”±è™•åˆ†ï¼
                    </p>
                </div>
            `;
            document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>
