<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å¯Œé‚¦ä¿Šå¾· | å‚³æ‰¿ä¿å…¨æ™ºæ…§è©¦ç®—</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f8fafc; }
        .card { background: white; border-radius: 1.5rem; border: 1px solid #e2e8f0; padding: 1.5rem; margin-bottom: 1.25rem; }
        .fubon-blue { color: #004a99; }
        .bg-fubon-blue { background-color: #004a99; }
    </style>
</head>
<body class="pb-12">
    <div class="max-w-md mx-auto p-4">
        
        <div class="flex items-center gap-4 bg-white p-6 rounded-[2rem] shadow-sm border border-slate-100 mb-6 mt-4">
            <div class="w-20 h-20 rounded-full overflow-hidden border-2 border-blue-100 shadow-sm shrink-0">
                <img src="https://drive.google.com/thumbnail?id=1DIjJdTt_HDEYrAJVj0yKzbO81pQG2Ndh&sz=w200" alt="ä¿Šå¾·ç…§ç‰‡" class="w-full h-full object-cover">
            </div>
            <div>
                <h2 class="text-xl font-black fubon-blue">å¯Œé‚¦äººå£½ | ä¿Šå¾·</h2>
                <p class="text-[10px] font-bold text-slate-400 tracking-widest mt-0.5">å°ˆæ¥­éºç”¢è¦åŠƒèˆ‡è³‡ç”¢ä¿å…¨</p>
                <div class="mt-2 inline-block bg-blue-50 text-blue-600 text-[10px] px-2 py-1 rounded-md font-bold">
                    ğŸ›¡ï¸ æ‚¨çš„å®¶æ—è³‡ç”¢å®ˆè­·è€…
                </div>
            </div>
        </div>

        <div class="text-center mb-6 px-4">
            <h1 class="text-2xl font-black text-slate-800 leading-tight">éºç”¢ç‰¹ç•™åˆ†æ™ºæ…§åˆ†æ</h1>
            <p class="text-slate-400 text-xs mt-1 font-bold italic underline decoration-blue-200">å³æ™‚åŒæ­¥æ†²æ³•æ³•åº­æœ€æ–°åˆ¤æ±ºè¶¨å‹¢</p>
        </div>

        <div class="card border-t-4 border-t-[#004a99]">
            <h3 class="font-bold text-slate-700 mb-4 flex items-center gap-2">è³‡ç”¢æ¦‚æ³</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-xs text-blue-700 font-black mb-1 italic">æˆ¿åœ°ç”¢ / åœŸåœ° (æŒ‰å¸‚åƒ¹è¨ˆ)</label>
                    <input type="number" id="realEstate" placeholder="è«‹è¼¸å…¥é‡‘é¡" class="w-full p-4 bg-slate-50 rounded-2xl border-0 text-right font-bold text-lg">
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-xs text-slate-500 mb-1 font-bold">å­˜æ¬¾ / ç¾é‡‘</label>
                        <input type="number" id="cash" placeholder="0" class="w-full p-4 bg-slate-50 rounded-2xl border-0 text-right font-bold">
                    </div>
                    <div>
                        <label class="block text-xs text-slate-500 mb-1 font-bold">è‚¡ç¥¨ / åŸºé‡‘</label>
                        <input type="number" id="stock" placeholder="0" class="w-full p-4 bg-slate-50 rounded-2xl border-0 text-right font-bold">
                    </div>
                </div>
            </div>
        </div>

        <div class="card">
            <h3 class="font-bold text-slate-700 mb-4 flex items-center gap-2 border-l-4 border-blue-600 pl-3">ç¹¼æ‰¿å°è±¡</h3>
            <div class="space-y-4">
                <div class="flex items-center justify-between p-4 bg-blue-50 rounded-2xl border border-blue-100">
                    <span class="font-bold text-blue-800 text-sm">é…å¶æ˜¯å¦åœ¨ä¸–</span>
                    <input type="checkbox" id="hasSpouse" class="w-6 h-6 rounded text-blue-600 focus:ring-blue-500">
                </div>
                <select id="rank" class="w-full p-4 bg-slate-50 border-0 rounded-2xl font-bold text-slate-700 text-sm" onchange="toggleLabel()">
                    <option value="1">ç¬¬ä¸€é †ä½ï¼šç›´ç³»å‘è¦ªå±¬ (å­å¥³)</option>
                    <option value="2">ç¬¬äºŒé †ä½ï¼šçˆ¶æ¯</option>
                    <option value="3">ç¬¬ä¸‰é †ä½ï¼šå…„å¼Ÿå§Šå¦¹</option>
                    <option value="4">ç¬¬å››é †ä½ï¼šç¥–çˆ¶æ¯</option>
                </select>
                <div class="flex items-center justify-between px-2">
                    <span id="heirLabel" class="text-slate-600 font-bold text-sm">å­å¥³ç¸½äººæ•¸ï¼š</span>
                    <input type="number" id="heirCount" value="1" min="1" class="w-16 bg-slate-100 p-2 text-center rounded-lg border-0 font-black">
                </div>
            </div>
        </div>

        <button onclick="calculate()" class="w-full bg-slate-800 text-white py-5 rounded-3xl font-black shadow-xl active:scale-95 transition-all text-lg mb-8">ğŸ“Š ç”¢å‡ºæ™ºæ…§åˆ†æå ±å‘Š</button>

        <div id="resultArea" class="hidden animate-in fade-in slide-in-from-bottom-4 duration-500 pb-10">
            <div class="bg-white rounded-[2.5rem] shadow-2xl overflow-hidden border border-slate-200">
                <div class="bg-[#004a99] p-6 text-center text-white">
                    <p class="text-[10px] font-bold tracking-widest opacity-80 mb-1 tracking-tighter uppercase font-mono">Asset Equalization Report</p>
                    <h3 class="font-black text-xl">è³‡ç”¢ä¿å…¨èˆ‡å„ªåŒ–å»ºè­°</h3>
                </div>
                
                <div id="resultContent" class="p-6 space-y-6"></div>

                <div class="p-6 pt-0">
                    <a href="https://line.me/ti/p/ä½ çš„ID" class="block w-full bg-green-500 text-white text-center py-4 rounded-2xl font-black shadow-lg shadow-green-100">ğŸ’¬ è¯ç¹«ä¿Šå¾·é€²è¡Œ 1 å° 1 è«®è©¢</a>
                </div>

                <div class="p-6 bg-slate-50 border-t border-slate-100 text-[10px] text-slate-400 leading-relaxed">
                    <p class="font-bold mb-1 text-slate-500 underline">âš ï¸ é‡è¦æ³•å¾‹è²æ˜èˆ‡è­¦èªï¼š</p>
                    <ul class="list-disc pl-4 space-y-1">
                        <li>æœ¬è©¦ç®—ä¿‚ä¾æ°‘æ³•ç¹¼æ‰¿ç·¨èˆ‡ä¿éšªæ³•ç¬¬112æ¢é€²è¡Œã€‚</li>
                        <li><b>æ³•å¾‹å‹•æ…‹ï¼š</b> é‡å°å…„å¼Ÿå§Šå¦¹ç‰¹ç•™åˆ†ï¼Œæ‡‰åƒè€ƒ 113 å¹´æ†²åˆ¤å­—ç¬¬ 3 è™Ÿåˆ¤æ±ºç²¾ç¥ã€‚</li>
                        <li><b>å…¬åŒå…±æœ‰é¢¨éšªï¼š</b> ç¾é‡‘ä¸è¶³æ”¯ä»˜ç‰¹ç•™åˆ†æ™‚ï¼Œæˆ¿ç”¢ç”¢æ¬Šæé­é–æ­»ã€‚</li>
                        <li>å¯¦éš›æ–¹æ¡ˆè«‹å‹™å¿…è«®è©¢å£½éšªé¡§å•<b>ä¿Šå¾·</b>é€²è¡Œå€‹æ¡ˆè©•ä¼°ã€‚</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        function toggleLabel(){ 
            const labels = ["å­å¥³ç¸½äººæ•¸", "çˆ¶æ¯äººæ•¸", "å…„å¼Ÿå§Šå¦¹äººæ•¸", "ç¥–çˆ¶æ¯äººæ•¸"];
            document.getElementById('heirLabel').innerText = labels[document.getElementById('rank').value-1] + "ï¼š";
        }

        function calculate() {
            const re = parseFloat(document.getElementById('realEstate').value) || 0;
            const cash = parseFloat(document.getElementById('cash').value) || 0;
            const stock = parseFloat(document.getElementById('stock').value) || 0;
            const hasSpouse = document.getElementById('hasSpouse').checked;
            const rank = parseInt(document.getElementById('rank').value);
            const count = parseInt(document.getElementById('heirCount').value) || 1;

            const totalBefore = re + cash + stock;
            if (totalBefore <= 0) { alert('è«‹è¼¸å…¥é‡‘é¡'); return; }

            let insShift = cash + stock;
            let ratio = (insShift / totalBefore);
            let planName = "é‡‘èè³‡ç”¢å„ªåŒ–æ–¹æ¡ˆ";
            let isRealEstatePlan = false;

            if (ratio < 0.2) {
                insShift = re * 0.3;
                planName = "æˆ¿åœ°ç”¢æ´»åŒ–ä¿å…¨æ–¹æ¡ˆ";
                isRealEstatePlan = true;
            }

            const totalAfter = totalBefore - insShift;

            let sShare = 0, hShare = 0, hRate = (rank <= 2) ? 0.5 : 0.3333;
            if (hasSpouse) {
                if (rank === 1) { sShare = 1/(count+1); hShare = 1/(count+1); }
                else if (rank === 2 || rank === 3) { sShare = 0.5; hShare = 0.5/count; }
                else { sShare = 2/3; hShare = (1/3)/count; }
            } else { hShare = 1/count; }

            const resultArea = document.getElementById('resultArea');
            resultArea.classList.remove('hidden');

            let specialAlert = "";
            if (rank === 3) {
                specialAlert = `
                    <div class="p-4 bg-amber-50 rounded-2xl border-l-4 border-amber-400">
                        <h5 class="text-amber-800 font-black text-xs mb-1">âš–ï¸ æ†²æ³•æ³•åº­ä¿®æ³•æé†’</h5>
                        <p class="text-[10px] text-amber-700 font-medium leading-relaxed">
                            ä¾æ“š 113 å¹´æ†²åˆ¤å­—ç¬¬ 3 è™Ÿï¼Œå…„å¼Ÿå§Šå¦¹ç‰¹ç•™åˆ†åˆ¶åº¦éƒ¨åˆ†é•æ†²ã€‚é›–ç„¶ç›®å‰æ³•å¾‹å°šæœªå®Œæˆä¿®æ­£ï¼Œä½†é€éä¿éšªã€ŒæŒ‡å®šå—ç›Šäººã€èƒ½æ›´æœ‰æ•ˆé é˜²ä¿®æ³•éæ¸¡æœŸçš„åˆ†é…çˆ­è­°ã€‚
                        </p>
                    </div>
                `;
            }

            document.getElementById('resultContent').innerHTML = `
                <div class="grid grid-cols-2 gap-4">
                    <div class="p-4 bg-slate-50 rounded-2xl text-center border border-slate-100">
                        <p class="text-[10px] text-slate-400 font-black uppercase tracking-wider">åŸå§‹è³‡ç”¢æ·¨é¡</p>
                        <p class="text-xl font-black text-slate-700">${Math.round(totalBefore).toLocaleString()}è¬</p>
                    </div>
                    <div class="p-4 bg-[#004a99] rounded-2xl text-center shadow-lg">
                        <p class="text-[10px] text-blue-200 font-black uppercase tracking-wider">å„ªåŒ–å¾Œéºç”¢</p>
                        <p class="text-xl font-black text-white">${Math.round(totalAfter).toLocaleString()}è¬</p>
                    </div>
                </div>

                <div class="bg-blue-50 p-5 rounded-3xl border border-blue-100">
                    <p class="font-black text-sm text-[#004a99] mb-1">ğŸ¯ ä¿Šå¾·è¦åŠƒå»ºè­°ï¼š${planName}</p>
                    <p class="text-xs text-blue-700 leading-relaxed font-bold">
                        å»ºè­°è¦åŠƒ <span class="bg-blue-600 text-white px-2 rounded-lg">${Math.round(insShift).toLocaleString()} è¬</span> æ–¼ä¿éšªé ç•™é‡‘ï¼Œé™¤äº†ç¯€çœç‰¹ç•™åˆ†é–€æª»ï¼Œæ›´å¯ä½œç‚ºã€Œè£œå„Ÿé‡‘ã€ç¢ºä¿ç”¢æ¬Šã€‚
                    </p>
                </div>

                ${specialAlert}

                <div class="p-5 bg-red-50 rounded-3xl border border-red-200 border-l-8 border-l-red-500">
                    <h5 class="text-red-700 font-black text-xs mb-1 italic">âš ï¸ æ ¸å¿ƒå±æ©Ÿï¼šé¿å…ç¥–ç”¢é–æ­»</h5>
                    <p class="text-[11px] text-red-600 leading-relaxed font-bold">
                        è‹¥ç„¡è¶³å¤ ç¾é‡‘å½Œè£œå…¶ä»–ç¹¼æ‰¿äººä¹‹ç‰¹ç•™åˆ†ï¼Œæˆ¿ç”¢æè¢«æ‰“å›ã€Œå…¬åŒå…±æœ‰ã€ï¼Œå±†æ™‚ä»»ä½•è²·è³£ã€æŠµæŠ¼çš†éœ€å…¨å“¡åŒæ„ï¼Œå°è‡´ç¥–ç”¢å› ä¸€äººåå°è€Œé™·å…¥ç„¡é™æœŸé–æ­»ã€‚
                    </p>
                </div>

                <div class="space-y-4">
                    <h4 class="text-[10px] font-black text-slate-400 tracking-widest uppercase ml-1">è¦åŠƒå¾Œç‰¹ç•™åˆ†å·®ç•°</h4>
                    ${renderRow("é…å¶", sShare, 0.5, totalBefore, totalAfter, hasSpouse)}
                    ${renderRow(`ç¬¬ ${rank} é †ä½ç¹¼æ‰¿äºº`, hShare, hRate, totalBefore, totalAfter, true)}
                </div>
            `;
            resultArea.scrollIntoView({ behavior: 'smooth' });
        }

        function renderRow(label, share, rate, b, a, show) {
            if (!show) return '';
            const bV = b * share * rate, aV = a * share * rate;
            return `
                <div class="flex justify-between items-center bg-slate-50 p-4 rounded-2xl border border-slate-100 shadow-sm">
                    <span class="text-[11px] font-black text-slate-600">${label}</span>
                    <div class="text-right">
                        <span class="text-[10px] text-slate-300 line-through mr-1 font-bold">${bV.toFixed(1)}è¬</span>
                        <span class="text-md font-black text-[#004a99]">${aV.toFixed(1)}è¬</span>
                        <span class="text-[9px] font-bold text-white bg-emerald-500 px-2 rounded-full ml-1">é™ ${Math.round(((bV-aV)/bV)*100)}%</span>
                    </div>
                </div>
            `;
        }
    </script>
</body>
</html>
